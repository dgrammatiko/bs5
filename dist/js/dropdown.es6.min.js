import*as t from"./popper/index.js";import{createPopper as e}from"./popper/index.js";import o from"./dom/data.js";import n from"./dom/event-handler.js";import r from"./dom/manipulator.js";import s from"./dom/selector-engine.js";const i=t=>(t[0]||t).nodeType,a=t=>{if(!t)return!1;if(t.style&&t.parentNode&&t.parentNode.style){const e=getComputedStyle(t),o=getComputedStyle(t.parentNode);return"none"!==e.display&&"none"!==o.display&&"hidden"!==e.visibility}return!1},d="rtl"===document.documentElement.dir,p="dropdown",l=new RegExp("ArrowUp|ArrowDown|Escape"),c=d?"top-end":"top-start",u=d?"top-start":"top-end",m=d?"bottom-end":"bottom-start",h=d?"bottom-start":"bottom-end",g=d?"left-start":"right-start",f=d?"right-start":"left-start",w={offset:0,flip:!0,boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null},_={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"};class b extends class{constructor(t){t&&(this._element=t,o.setData(t,this.constructor.DATA_KEY,this))}dispose(){o.removeData(this._element,this.constructor.DATA_KEY),this._element=null}static getInstance(t){return o.getData(t,this.DATA_KEY)}static get VERSION(){return"5.0.0-beta1"}}{constructor(t,e){super(t),this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}static get Default(){return w}static get DefaultType(){return _}static get DATA_KEY(){return"bs.dropdown"}toggle(){if(this._element.disabled||this._element.classList.contains("disabled"))return;const t=this._element.classList.contains("show");b.clearMenus(),t||this.show()}show(){if(this._element.disabled||this._element.classList.contains("disabled")||this._menu.classList.contains("show"))return;const o=b.getParentFromElement(this._element),r={relatedTarget:this._element};if(!n.trigger(this._element,"show.bs.dropdown",r).defaultPrevented){if(!this._inNavbar){if(void 0===t)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let n=this._element;"parent"===this._config.reference?n=o:i(this._config.reference)&&(n=this._config.reference,void 0!==this._config.reference.jquery&&(n=this._config.reference[0])),this._popper=e(n,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav")&&[].concat(...document.body.children).forEach(t=>n.on(t,"mouseover",null,(function(){}))),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.toggle("show"),this._element.classList.toggle("show"),n.trigger(o,"shown.bs.dropdown",r)}}hide(){if(this._element.disabled||this._element.classList.contains("disabled")||!this._menu.classList.contains("show"))return;const t=b.getParentFromElement(this._element),e={relatedTarget:this._element};n.trigger(t,"hide.bs.dropdown",e).defaultPrevented||(this._popper&&this._popper.destroy(),this._menu.classList.toggle("show"),this._element.classList.toggle("show"),n.trigger(t,"hidden.bs.dropdown",e))}dispose(){super.dispose(),n.off(this._element,".bs.dropdown"),this._menu=null,this._popper&&(this._popper.destroy(),this._popper=null)}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_addEventListeners(){n.on(this._element,"click.bs.dropdown",t=>{t.preventDefault(),t.stopPropagation(),this.toggle()})}_getConfig(t){return t={...this.constructor.Default,...r.getDataAttributes(this._element),...t},((t,e,o)=>{Object.keys(o).forEach(n=>{const r=o[n],s=e[n],a=s&&i(s)?"element":null==(d=s)?""+d:{}.toString.call(d).match(/\s([a-z]+)/i)[1].toLowerCase();var d;if(!new RegExp(r).test(a))throw new Error(t.toUpperCase()+": "+`Option "${n}" provided type "${a}" `+`but expected type "${r}".`)})})(p,t,this.constructor.DefaultType),t}_getMenuElement(){return s.next(this._element,".dropdown-menu")[0]}_getPlacement(){const t=this._element.parentNode;if(t.classList.contains("dropend"))return g;if(t.classList.contains("dropstart"))return f;const e="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return t.classList.contains("dropup")?e?u:c:e?h:m}_detectNavbar(){return null!==this._element.closest(".navbar")}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{altBoundary:this._config.flip,rootBoundary:this._config.boundary}}]};return"static"===this._config.display&&(t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...this._config.popperConfig}}static dropdownInterface(t,e){let n=o.getData(t,"bs.dropdown");if(n||(n=new b(t,"object"==typeof e?e:null)),"string"==typeof e){if(void 0===n[e])throw new TypeError(`No method named "${e}"`);n[e]()}}static jQueryInterface(t){return this.each((function(){b.dropdownInterface(this,t)}))}static clearMenus(t){if(t&&(2===t.button||"keyup"===t.type&&"Tab"!==t.key))return;const e=s.find('[data-bs-toggle="dropdown"]');for(let r=0,s=e.length;r<s;r++){const s=b.getParentFromElement(e[r]),i=o.getData(e[r],"bs.dropdown"),a={relatedTarget:e[r]};if(t&&"click"===t.type&&(a.clickEvent=t),!i)continue;const d=i._menu;e[r].classList.contains("show")&&(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&"Tab"===t.key)&&d.contains(t.target)||n.trigger(s,"hide.bs.dropdown",a).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(t=>n.off(t,"mouseover",null,(function(){}))),e[r].setAttribute("aria-expanded","false"),i._popper&&i._popper.destroy(),d.classList.remove("show"),e[r].classList.remove("show"),n.trigger(s,"hidden.bs.dropdown",a)))}}static getParentFromElement(t){return(t=>{const e=(t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){const o=t.getAttribute("href");e=o&&"#"!==o?o.trim():null}return e})(t);return e?document.querySelector(e):null})(t)||t.parentNode}static dataApiKeydownHandler(t){if(/input|textarea/i.test(t.target.tagName)?"Space"===t.key||"Escape"!==t.key&&("ArrowDown"!==t.key&&"ArrowUp"!==t.key||t.target.closest(".dropdown-menu")):!l.test(t.key))return;if(t.preventDefault(),t.stopPropagation(),this.disabled||this.classList.contains("disabled"))return;const e=b.getParentFromElement(this),o=this.classList.contains("show");if("Escape"===t.key)return(this.matches('[data-bs-toggle="dropdown"]')?this:s.prev(this,'[data-bs-toggle="dropdown"]')[0]).focus(),void b.clearMenus();if(!o||"Space"===t.key)return void b.clearMenus();const n=s.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",e).filter(a);if(!n.length)return;let r=n.indexOf(t.target);"ArrowUp"===t.key&&r>0&&r--,"ArrowDown"===t.key&&r<n.length-1&&r++,r=-1===r?0:r,n[r].focus()}}var y;n.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]',b.dataApiKeydownHandler),n.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",b.dataApiKeydownHandler),n.on(document,"click.bs.dropdown.data-api",b.clearMenus),n.on(document,"keyup.bs.dropdown.data-api",b.clearMenus),n.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]',(function(t){t.preventDefault(),t.stopPropagation(),b.dropdownInterface(this,"toggle")})),n.on(document,"click.bs.dropdown.data-api",".dropdown form",t=>t.stopPropagation()),y=()=>{const t=(()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null})();if(t){const e=t.fn[p];t.fn[p]=b.jQueryInterface,t.fn[p].Constructor=b,t.fn[p].noConflict=()=>(t.fn[p]=e,b.jQueryInterface)}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",y):y(),window.Joomla=window.Joomla||{},window.Joomla.Bootstrap=window.Joomla.Bootstrap||{},window.Joomla.Bootstrap.Dropdown=b;export default b;
