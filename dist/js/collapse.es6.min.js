import t from"./dom/data.js";import e from"./dom/event-handler.js";import s from"./dom/manipulator.js";import n from"./dom/selector-engine.js";const i=t=>{let e=t.getAttribute("data-bs-target");if(!e||"#"===e){const s=t.getAttribute("href");e=s&&"#"!==s?s.trim():null}return e},o=t=>{const e=i(t);return e&&document.querySelector(e)?e:null},a=t=>{const e=i(t);return e?document.querySelector(e):null},r=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(t);const n=Number.parseFloat(e),i=Number.parseFloat(s);return n||i?(e=e.split(",")[0],s=s.split(",")[0],1e3*(Number.parseFloat(e)+Number.parseFloat(s))):0},l=t=>(t[0]||t).nodeType,c=(t,e)=>{let s=!1;const n=e+5;t.addEventListener("transitionend",(function e(){s=!0,t.removeEventListener("transitionend",e)})),setTimeout(()=>{s||(t=>{t.dispatchEvent(new Event("transitionend"))})(t)},n)};document.documentElement.dir;const h="collapse",g="bs.collapse",d={toggle:!0,parent:""},p={toggle:"boolean",parent:"(string|element)"};class u extends class{constructor(e){e&&(this._element=e,t.setData(e,this.constructor.DATA_KEY,this))}dispose(){t.removeData(this._element,this.constructor.DATA_KEY),this._element=null}static getInstance(e){return t.getData(e,this.DATA_KEY)}static get VERSION(){return"5.0.0-beta1"}}{constructor(t,e){super(t),this._isTransitioning=!1,this._config=this._getConfig(e),this._triggerArray=n.find(`[data-bs-toggle="collapse"][href="#${t.id}"],[data-bs-toggle="collapse"][data-bs-target="#${t.id}"]`);const s=n.find('[data-bs-toggle="collapse"]');for(let e=0,i=s.length;e<i;e++){const i=s[e],a=o(i),r=n.find(a).filter(e=>e===t);null!==a&&r.length&&(this._selector=a,this._triggerArray.push(i))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}static get Default(){return d}static get DATA_KEY(){return g}toggle(){this._element.classList.contains("show")?this.hide():this.show()}show(){if(this._isTransitioning||this._element.classList.contains("show"))return;let s,i;this._parent&&(s=n.find(".show, .collapsing",this._parent).filter(t=>"string"==typeof this._config.parent?t.getAttribute("data-bs-parent")===this._config.parent:t.classList.contains("collapse")),0===s.length&&(s=null));const o=n.findOne(this._selector);if(s){const e=s.find(t=>o!==t);if(i=e?t.getData(e,g):null,i&&i._isTransitioning)return}if(e.trigger(this._element,"show.bs.collapse").defaultPrevented)return;s&&s.forEach(e=>{o!==e&&u.collapseInterface(e,"hide"),i||t.setData(e,g,null)});const a=this._getDimension();this._element.classList.remove("collapse"),this._element.classList.add("collapsing"),this._element.style[a]=0,this._triggerArray.length&&this._triggerArray.forEach(t=>{t.classList.remove("collapsed"),t.setAttribute("aria-expanded",!0)}),this.setTransitioning(!0);const l="scroll"+(a[0].toUpperCase()+a.slice(1)),h=r(this._element);e.one(this._element,"transitionend",()=>{this._element.classList.remove("collapsing"),this._element.classList.add("collapse","show"),this._element.style[a]="",this.setTransitioning(!1),e.trigger(this._element,"shown.bs.collapse")}),c(this._element,h),this._element.style[a]=this._element[l]+"px"}hide(){if(this._isTransitioning||!this._element.classList.contains("show"))return;if(e.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const t=this._getDimension();this._element.style[t]=this._element.getBoundingClientRect()[t]+"px",this._element.offsetHeight,this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show");const s=this._triggerArray.length;if(s>0)for(let t=0;t<s;t++){const e=this._triggerArray[t],s=a(e);s&&!s.classList.contains("show")&&(e.classList.add("collapsed"),e.setAttribute("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[t]="";const n=r(this._element);e.one(this._element,"transitionend",()=>{this.setTransitioning(!1),this._element.classList.remove("collapsing"),this._element.classList.add("collapse"),e.trigger(this._element,"hidden.bs.collapse")}),c(this._element,n)}setTransitioning(t){this._isTransitioning=t}dispose(){super.dispose(),this._config=null,this._parent=null,this._triggerArray=null,this._isTransitioning=null}_getConfig(t){return(t={...d,...t}).toggle=Boolean(t.toggle),((t,e,s)=>{Object.keys(s).forEach(n=>{const i=s[n],o=e[n],a=o&&l(o)?"element":null==(r=o)?""+r:{}.toString.call(r).match(/\s([a-z]+)/i)[1].toLowerCase();var r;if(!new RegExp(i).test(a))throw new Error(t.toUpperCase()+": "+`Option "${n}" provided type "${a}" `+`but expected type "${i}".`)})})(h,t,p),t}_getDimension(){return this._element.classList.contains("width")?"width":"height"}_getParent(){let{parent:t}=this._config;l(t)?void 0===t.jquery&&void 0===t[0]||(t=t[0]):t=n.findOne(t);const e=`[data-bs-toggle="collapse"][data-bs-parent="${t}"]`;return n.find(e,t).forEach(t=>{const e=a(t);this._addAriaAndCollapsedClass(e,[t])}),t}_addAriaAndCollapsedClass(t,e){if(!t||!e.length)return;const s=t.classList.contains("show");e.forEach(t=>{s?t.classList.remove("collapsed"):t.classList.add("collapsed"),t.setAttribute("aria-expanded",s)})}static collapseInterface(e,n){let i=t.getData(e,g);const o={...d,...s.getDataAttributes(e),..."object"==typeof n&&n?n:{}};if(!i&&o.toggle&&"string"==typeof n&&/show|hide/.test(n)&&(o.toggle=!1),i||(i=new u(e,o)),"string"==typeof n){if(void 0===i[n])throw new TypeError(`No method named "${n}"`);i[n]()}}static jQueryInterface(t){return this.each((function(){u.collapseInterface(this,t)}))}}var m;e.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',(function(e){"A"===e.target.tagName&&e.preventDefault();const i=s.getDataAttributes(this),a=o(this);n.find(a).forEach(e=>{const s=t.getData(e,g);let n;s?(null===s._parent&&"string"==typeof i.parent&&(s._config.parent=i.parent,s._parent=s._getParent()),n="toggle"):n=i,u.collapseInterface(e,n)})})),m=()=>{const t=(()=>{const{jQuery:t}=window;return t&&!document.body.hasAttribute("data-bs-no-jquery")?t:null})();if(t){const e=t.fn[h];t.fn[h]=u.jQueryInterface,t.fn[h].Constructor=u,t.fn[h].noConflict=()=>(t.fn[h]=e,u.jQueryInterface)}},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m(),window.Joomla=window.Joomla||{},window.Joomla.Bootstrap={},window.Joomla.Bootstrap.Collapse=u;export default u;
